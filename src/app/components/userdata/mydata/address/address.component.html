<div id="content">
   <div id="header">
      <h1>Mis direcciones</h1>
      <p class="btn"><span class="material-symbols-outlined">add</span> Añadir dirección</p>
   </div>
   <!-- For direccion in direcciones -->
   <div id="alladdress">

      <div *ngIf="myaddress" class="address">
         <div class="card_header">
            <b>Dirección predeterminada</b>
         </div>
         <div class="card_body">
            <p><b>{{ myaddress.recipient }}</b></p>
            <p> {{ myaddress.street }} </p>
            <p> {{ myaddress.details }} </p>
            <p> {{ myaddress.city }}, {{ myaddress.province }} {{ myaddress.zipcode }} </p>
            <p> {{ myaddress.phone }} </p>
         </div>
         <div class="card_footer">
            <p data-bs-toggle="modal" data-bs-target="#addressModal">Editar</p>
            <p (click)="delAddress(myaddress.id)">Eliminar</p>
         </div>
      </div>

      <div *ngFor="let address of alladdress" class="address">
         <div class="card_header">
            <p>Elegir como predeterminada</p>
         </div>
         <div class="card_body">
            <p><b>{{ address.recipient }}</b></p>
            <p> {{ address.street }} </p>
            <p> {{ address.details }} </p>
            <p> {{ address.city }}, {{ address.province }} {{ address.zipcode }} </p>
            <p> {{ address.phone }} </p>
         </div>
         <div class="card_footer">
            <p>Editar</p>
            <p (click)="delAddress(address.id)">Eliminar</p>
         </div>
      </div>
   </div>
</div>





<!-- ADDRESS MODAL -->
<div class="modal fade" id="addressModal" tabindex="-1" aria-labelledby="addressModalLabel" aria-hidden="true">
   <div class="modal-dialog">
      <div class="modal-content">
         <div class="modal-header">
            <h1 class="modal-title fs-5" id="addressModalLabel">Editar dirección</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>
         <div class="modal-body">
            <form [formGroup]="form" id="addressForm" (ngSubmit)="onSubmit()">

               <div class="form-group">
                  <p>Dirección:</p>
                  <input matInput placeholder="Nombre y número de calle" formControlName="street" class="form-control"
                     [ngClass]="{ 'is-invalid': submitted && f['street'].errors }" />
                  @if (submitted && f['street'].errors) { <div class="invalid-feedback">
                     @if (f['street'].errors['required']) { <div>Campo obligatorio</div> } </div>}
               </div>

               <div class="form-group">
                  <p>Detalles de dirección:</p>
                  <input matInput placeholder="Edificio, piso o apartamento" formControlName="details"
                     class="form-control" [ngClass]="{ 'is-invalid': submitted && f['details'].errors }" />
                  @if (submitted && f['details'].errors) { <div class="invalid-feedback">
                     @if (f['details'].errors['required']) { <div>Campo obligatorio</div> } </div>}
               </div>

               <div class="doble">
                  <div class="form-group">
                     <p>Ciudad:</p>
                     <input matInput formControlName="city" class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && f['city'].errors }" />
                     @if (submitted && f['city'].errors) { <div class="invalid-feedback">
                        @if (f['city'].errors['required']) { <div>Campo obligatorio</div> } </div>}
                  </div>
                  <div class="form-group">
                     <p>Código postal:</p>
                     <input matInput formControlName="zipcode" class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && f['zipcode'].errors }" />
                     @if (submitted && f['zipcode'].errors) { <div class="invalid-feedback">
                        @if (f['zipcode'].errors['required']) { <div>Campo obligatorio</div> } </div>}
                  </div>
               </div>
               <div class="form-group">
                  <p>Provincia:</p>
                  <input matInput formControlName="province" class="form-control"
                     [ngClass]="{ 'is-invalid': submitted && f['province'].errors }" />
                  @if (submitted && f['province'].errors) { <div class="invalid-feedback">
                     @if (f['province'].errors['required']) { <div>Campo obligatorio</div> } </div>}
               </div>
               <button type="submit" class="btn btn-primary">Guardar Cambios</button>
            </form>
         </div>
      </div>
   </div>
</div>